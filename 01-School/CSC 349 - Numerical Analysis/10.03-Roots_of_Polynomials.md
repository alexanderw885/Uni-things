In this class, we'll be writing polynomials with powers in ascending order:
$$f(x)=a_0+a_1x+a_2x^2+...+a_nx^n=\sum_{i=0}^{n}a_ix^i$$
or,
$$f(x)=a_n(x-r_1)^{m_1}(x-r_2)^{m_2}...(x-r_k)^{m_k}$$
with $\sum_{j=1}^{k}m_j=n$

One approach is to use the [Newton-Raphson method](09.24-Root_Finding):
$$x_{i+1}=x_i-\frac{f(x_i)}{f'(x_i)}$$
but this does not compute complex roots, and it can be difficult to find *all* the roots

# Horner's Algorithm
**An efficient way to calculate a polynomial and it's derivative at a point**

we can change the form of the polynomial to make it more efficient to compute:

We convert:
$$f(x)=a_0+a_1x+a_2x^2+a_3x^3+a_4x^4$$
into a nested form:
$$f(x)=a_0+x(a_1+x(a_2+x(a_3 + x(a_4))))$$
This gives the same result, but in fewer multiplications.

How should we evaluate it? 
![[Pasted image 20251003105920.png]]
typo, the bottom $b_0$ should be $x_0$
More compactly:
$$b_k=a_k+b_{k+1}x_0\text{ for }k=n-1,n-2,...,1,0$$
we can also rearrange to solve for a:
$$a_k=b_k-b_{k+1}$$

Now that we have these b values, let's define $Q$:
$$Q(x)=b_1+b_2x+...b_nx^{n-1}$$
so now:
$$f(x)=(x-x_0)Q(x)+b_0$$

what if we want the derivative?
$$f'(x)=Q(x)+(x-x_0)Q'(x)$$
which implies:
$$f-(x_0)=Q(x_0)$$

Now, we can finally perform the algorithm. Given that we have values $a_0...a_n$ and $x_0$, first compute all the b values:
![[Pasted image 20251003110733.png]]
Now we have the polynomial evaluated at $x_0$. Now, using these new $b$ values, we calculate the value of the derivative:
![[Pasted image 20251003110818.png]]

___
**Example**
$$f(x)=4-3x+2x^2-2x^3+x^4$$
evaluate where $x_0=1$
$b_4=a_4=1$
$b_3=a_3+b_4x_0=-2+(1)=-1$
$b_2=a_2+b_3x_0=2+(-1)=1$
$b_1=a_1+b_2x_0=-3+1=-2$
$b_0=a_0+b_1x_0=4+(-2)(1)=2$ 

$f(1)=2$

Now we have the $b$ values, we can calculate the derivative at $x_0=1$:
$c_4=b_4=1$
$c_3=b_3+c_4x_0=-1+1(1)=0$
$c_2=b_2+c_3x_0=1+(0)(1)=1$
$c_1=b_1+c_2x_0=-2+(1)(1)=-1$

$f'(x)=-1$

**Note that this does not give us the explicit derivative formula, we need to redo all calculations each time we need a value**

### Polynomial Deflation
Once we've computed one zero $r_1$, we can "deflate" the function by factoring out that zero
$$\hat{f}(x)=\frac{f(x)}{x-r_1}$$
Now we can use Horner's algorithm to help calculate the next root, and deflate again

___
The full process is as follows:
- Use Newton's algorithm
- For each evaluation, use Horner's algorithm to get the value of the function and its derivative
- Once you find a zero, deflate the polynomial
- Put this new function into Newton's Algorithm.
- ...
- Repeat until all zeroes are found

There is one issue with this though: Since your zeroes are just approximates, when you factor them out you lose some precision. With each zero, you lose more accuracy. To get around this we use *Root Polishing*:
Let's say using this method, we find some $r_n$ from the deflated function. While it's not the actual root, it's at least close.
Use $r_n$ as an initial guess in the *original* function. Since it's close, it'll gravitate to the root, and give you a much better approximation.