How can we approximate a function, using a different, simpler type of function? Similar idea to Taylor series, approximating a function at a point with polynomials

These approximations can have a number of advantages
- continuity
- easy to integrate and differentiate
- easy to evaluate

there's three main classes used for approximations:
- Polynomials
- Piecewise polynomials (splines) 
- Trigonometric sums (Fourier series)

### Polynomial interpolation
$$P(x)=a_0+a_1x+a_2x^2+...+a_nx^n$$
if you have $n+1$ data points, there exists one and only one polynomial of order $n$ that passes through them all. Polynomial interpolation is trying to find that order $n$ polynomial for your data.

This is different from Taylor approximations. Taylor uses the function and it's derivative around one point, while interpolation doesn't know the function, just the value at some specific points.

#### Lagrange Interpolating Polynomial
given $(x_i,f(x_i))$, where $0\leq{}i\leq{}n$, and all $x_i$ are distinct, consider the function:
$$P(x)=\sum_{i=0}^nL_i(x)f(x_i)$$
remember, $x_i$ and $f(x_i)$ are given, we know what those are. We want to know what the function equals at $x$.
Here's how we define $L_i(x)$:
$$L_i(x)=\frac{(x-x_0)...(x-x_{i-1})...(x-x_{i+1})(x-x_n)}{(x_i-x_0)...(x_i-x_{i-1})(x_i-x_{i+1})...(x_i-x_n)}$$
$$\text{or}$$
$$L_i(x)=\prod_{j=0,j\neq{}i}^n\frac{x-x_j}{x_i-x_j}$$
Note that in both the numerator and denominator, the product does not include the $(x-x_i)$ term.

We can derive the general Lagrange interpolating polynomial for order 1:
$$P(x)=\frac{x-x_0}{x_1-x_0}f(x_0)+\frac{x-x_1}{x_0-x_1}f(x_1)$$
This equation grows quite large, quite fast. Here's order 2
$$P(x)=\prod_{j=0,j\neq{}0}^2(\frac{x-x_j}{x_0-x_j})f(x_0)+\prod_{j=0,j\neq{}1}^2(\frac{x-x_j}{x_1-x_j})f(x_1)+\prod_{j=0,j\neq{}2}^2(\frac{x-x_j}{x_2-x_j})f(x_2)$$

The denominator for each $L_i$ is a constant, so it can be calculated ahead of time. The numerator depends on our input $x$, so it has to be calculated when the whole approximation at a point is evaluated.

### Barycentric Lagrange Interpolation
In $L_i$, there's a lot of subtraction. This could be a problem due to subtractive cancellation. We can rewrite it to reduce subtractions.

Notice that in $L_i$, the numerator is just about the same in every term. So, why don't we calculate it ahead of time, and divide out the extra term?

$$L(x)=\prod_{j=0}^n(x-x_j)$$
Then we can define the rest of $L_i$ as $w_i$:
$$w_i=\frac{1}{\prod_{j=0,j\neq i}(x_i-x_j)}$$

This gives us the following relation:
$$L_i(x)=L(x)\frac{w_i}{x-x_i}$$
Now that we have this, we can rewrite Lagrange interpolation as follows:
$$P(x)=L(x)\sum_{i=1}^n\frac{w_i}{x-x_i}f(x_i)$$
We're still doing a lots of subtraction, but we're not repeating as much as we were before

### Finding the coefficients of the interpolating polynomial
For each of our points $f(x_0)...f(x_n)$ that we know, we can write it out as a matrix:
$$a_0+a_1x+...+a_nx^n=f(x_0)$$
$$a_0+a_1x+...+a_nx^n=f(x_1)$$
$$...$$
$$a_0+a_1x+...+a_nx^n=f(x_n)$$

Which is equivalent to:
![[Pasted image 20251022104808.png]]
We know all the $x$ values, we know the $f(x)$ values, we need to solve for $a$. We can do this with [Gaussian Elimination](10.07-Gaussian_Elimination).

Since for any $n+1$ points, there exists only one unique polynomial of degree $n$ that passes through all $n$ points, There is only one solution.
### Error term
if each point $x$ is within the range $[a,b]$ we can calculate the error at any point found with interpolation:
$$f(\hat{x})=P(\hat{x})+\frac{f^{(n+1)}(\xi)}{(n+1)!}\prod_{i=0}^n(\hat{x}-x_i)$$
Where $a\lt\xi\lt b$ 

This looks very similar to the [error in the Taylor series](10.03-Roots_of_Polynomials) 


ln(x)/x
(1-ln(x)) / (x**2)
(1-ln(x)) / ln(x)
332.8
0.002987
0.003976
0.3313