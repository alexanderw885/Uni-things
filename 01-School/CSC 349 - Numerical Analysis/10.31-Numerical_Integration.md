### Quadrature
the Quadrature is the process of determining the area by using simpler polygons. Something like estimating the area of a circle with triangles, or under a curve with rectangles.

These functions will usually be in one of three forms:
1. Simple, continuous function
2. complicated continuous function, difficult/impossible to perform analytical integration
3. discrete function where we have a set of points. Impossible to analytically integrate.

We want to calculate $\int_a^bf(x)dx$. Like always in this class, we'll convert it to a polynomial.
First, let's convert $f$ into a polynomial with [Lagrange interpolation](10.17-Lagrange_Interpolation):
$$f(x)\approx{}P(x)=\sum_{i=0}^nL_i(x)f(x_i)$$
then:
$$\int_a^bf(x)dx\approx\sum_{i=0}^n(\int_a^bL_i(x)dx)f(x_i)$$
This is the *quadrature formula*. 
There's three types of quadrature formulas:
1. Newton-Cotes closed
2. Newton-Cotes open
3. Gaussian
Both Newton-Cotes are for when we have equally-spaced points.

#### Newton-Cotes closed formulas
for any $n\geq1$, we divide the interval $[a,b]$ into sub-intervals of length $h$.  These intervals are separated by points $x_0,x_1,...,x_n$
If $P_n(x)$ interpolates $f(x)$ at all points $a=x_0,...,x_n$, and:
$$\int_a^bf(x)dx\approx\int_a^bP_n(x)dx)$$
Then the quadrature is Newton-Cotes closed form. 
For a linear interpolation of two points, this gives you the trapezoid rule for interpretation:
$$\frac{x_1-x_0}{2}(f(x_0)+f(x_1))$$
Now that we have our integral, how do we estimate our [error?](09.10-Errors) Remember, the remainder term for a Lagrange polynomial. If n=1:
$$\frac{f''(\xi)}{2}(x-x_0)(x-x_1)$$
where $\xi$ is in the range $[0,1]$. If we integrate it into:
$$-\frac{h^3}{12}f''(\xi)$$

#### Composite Newton-Cotes formula
This method works well, but just like curve fitting with Lagrange, overfitting the data is a problem when you have a lot of points. So, instead of Lagrange interpolation, we can use [piecewise interpolation.](10.29-Spline_Interpolation) In this case, it would be called *Composite* Interpolation.

Just like the closed formula, we use the trapezoidal rule. We can simplify it to the following formula:
![[Pasted image 20251105104157.png]]
And the error:
![[Pasted image 20251105104224.png]]where $x_{i-1}\leq\xi_i\leq{}x_i$.

As you get more and more points, error approaches zero. If we're able to query the function as many times as we want, how do we decide $m$, the number of points to use?
What we can do is start with 2, and keep doubling $m$ and repeating the approximation. Once two approximations are sufficiently close together, we decide that's good enough.

Why always multiply by 2? It's because the whole reason we're approximating is likely because the function itself is likely slow to query. By doubling, we can reuse all of the previous values.